{% extends "base.html" %}
{% block head %}
    <link rel="stylesheet" href="{{ url_for('static',filename ='admin-style.css') }}">
{% endblock %}
{% block title %}Admin Pannel{% endblock %}

{% block content %}
    <div class="hedder">
        <h5>Admin Dashbord</h5>
        <div class="search">
            <form method="get">
                <div class="wrapper-search">
                    <input class="search-bar" type="text" name="search" placeholder="Search users" autofocus>
                    <div class="wrapper-icon">
                        <input type="submit" value="search" class="search-icon">
                    </div>
                </div>
            </form>
        </div>
        <div class="date-time">
            <div class="date">
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#0a0909"><path d="M200-80q-33 0-56.5-23.5T120-160v-560q0-33 23.5-56.5T200-800h40v-80h80v80h320v-80h80v80h40q33 0 56.5 23.5T840-720v560q0 33-23.5 56.5T760-80H200Zm0-80h560v-400H200v400Zm0-480h560v-80H200v80Zm0 0v-80 80Zm280 240q-17 0-28.5-11.5T440-440q0-17 11.5-28.5T480-480q17 0 28.5 11.5T520-440q0 17-11.5 28.5T480-400Zm-160 0q-17 0-28.5-11.5T280-440q0-17 11.5-28.5T320-480q17 0 28.5 11.5T360-440q0 17-11.5 28.5T320-400Zm320 0q-17 0-28.5-11.5T600-440q0-17 11.5-28.5T640-480q17 0 28.5 11.5T680-440q0 17-11.5 28.5T640-400ZM480-240q-17 0-28.5-11.5T440-280q0-17 11.5-28.5T480-320q17 0 28.5 11.5T520-280q0 17-11.5 28.5T480-240Zm-160 0q-17 0-28.5-11.5T280-280q0-17 11.5-28.5T320-320q17 0 28.5 11.5T360-280q0 17-11.5 28.5T320-240Zm320 0q-17 0-28.5-11.5T600-280q0-17 11.5-28.5T640-320q17 0 28.5 11.5T680-280q0 17-11.5 28.5T640-240Z"/></svg>
                <span>{{dtime.strftime('%d/%b/%Y')}}</span>
            </div>
            <div class="time">
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#0a0909"><path d="m612-292 56-56-148-148v-184h-80v216l172 172ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-400Zm0 320q133 0 226.5-93.5T800-480q0-133-93.5-226.5T480-800q-133 0-226.5 93.5T160-480q0 133 93.5 226.5T480-160Z"/></svg>
                <span>{{dtime.strftime('%I:%M %p')}}</span>                
            </div>
        </div>
    </div>

                <!-- content of the page        -->

    <div class="admin-content">
        {% if datas | length > 1 %}
        <div class="cards">
            <div class="card user-count">
                <div class="card-text">
                    <h5>Total users</h5>
                    <span>{{count}}</span>
                </div>
                <svg xmlns="http://www.w3.org/2000/svg" height="40px" viewBox="0 -960 960 960" width="40px" fill="#ffffff"><path d="M480-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM160-160v-112q0-34 17.5-62.5T224-378q62-31 126-46.5T480-440q66 0 130 15.5T736-378q29 15 46.5 43.5T800-272v112H160Zm80-80h480v-32q0-11-5.5-20T700-306q-54-27-109-40.5T480-360q-56 0-111 13.5T260-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T560-640q0-33-23.5-56.5T480-720q-33 0-56.5 23.5T400-640q0 33 23.5 56.5T480-560Zm0-80Zm0 400Z"/></svg>    
            </div>
            <div class="card debt-zero">
                <div class="card-text">
                    <h5>Debt Free Users</h5>
                    <span>{{debt_zero}}</span>
                </div>
                <svg xmlns="http://www.w3.org/2000/svg" height="40px" viewBox="0 -960 960 960" width="40px" fill="#FFFFFF"><path d="M422-297.33 704.67-580l-49.34-48.67L422-395.33l-118-118-48.67 48.66L422-297.33ZM480-80q-82.33 0-155.33-31.5-73-31.5-127.34-85.83Q143-251.67 111.5-324.67T80-480q0-83 31.5-156t85.83-127q54.34-54 127.34-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 82.33-31.5 155.33-31.5 73-85.5 127.34Q709-143 636-111.5T480-80Zm0-66.67q139.33 0 236.33-97.33t97-236q0-139.33-97-236.33t-236.33-97q-138.67 0-236 97-97.33 97-97.33 236.33 0 138.67 97.33 236 97.33 97.33 236 97.33ZM480-480Z"/></svg>
            </div>
            <div class="card debt-total">
                <div class="card-text">
                    <h5>Total Debt</h5>
                    <span>RS.{{debt_sum}}</span>
                </div>
                <svg xmlns="http://www.w3.org/2000/svg" height="40px" viewBox="0 -960 960 960" width="40px" fill="#FFFFFF"><path d="M576-621.33q-13.33-32.67-38.5-51-25.17-18.34-60.17-18.34-26.66 0-48.33 8.67-21.67 8.67-37.67 26.67L344-702.67q18.67-20.66 45-33.83 26.33-13.17 53.67-16.83V-840h66.66v85.33q43 6.34 77.34 32.5Q621-696 640-649.33l-64 28ZM801.33-56 612-245.33q-19.67 19-47.33 28.83-27.67 9.83-55.34 11.83V-120h-66.66v-86q-56.67-10-94.5-47.33-37.84-37.34-54.17-92L360.67-370q13.33 48 43.83 74.67 30.5 26.66 78.17 26.66 23.33 0 44.66-5.83 21.34-5.83 36-19.5L56.67-800.67 104-848l744.67 744.67L801.33-56Z"/></svg>
            </div>
            
            <div class="card flag-users">
                <div class="card-text">
                    <h5>Unpaid users</h5>
                    <span>{{count - debt_zero}}</span>
                </div>
                <svg xmlns="http://www.w3.org/2000/svg" height="40px" viewBox="0 -960 960 960" width="40px" fill="#FFFFFF"><path d="M500-568ZM200-120v-680h272.67q-5 16-7.67 33t-3.67 33.67H266.67V-486H574l18 83.33h141.33V-460q16.67-.67 33.67-3.33 17-2.67 33-8V-336H536l-17.96-83.33H266.67V-120H200Zm495.67-516L836-776.67l-32.67-32.66-107.66 107.66-52.34-53L610.67-721l85 85Zm27.66-282.67q81.34 0 138.67 57.33 57.33 57.33 57.33 138.67 0 81.34-57.33 138.67-57.33 57.33-138.67 57.33-81.34 0-138.67-57.33-57.33-57.33-57.33-138.67 0-81.34 57.33-138.67 57.33-57.33 138.67-57.33Z"/></svg>
            </div>

        </div>
    
        <div class="data-tables">
            <div class="table-all">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Id</th>
                            <th>Username</th>
                            <th>Debt</th>
                            <th></th>
                        </tr>
                    </thead>
                
                    {% for data in datas %}
                    <tbody>
                        <tr>
                            <td>{{data.id-1}}</td>
                            <td>{{data.user}}</td>
                            <td>Rs.{{data.debt}}</td>
                            <td><a href="{{ url_for('edituser', id=data.id) }}" class="btn btn-info">Edit</a></td>
                        </tr>
                    </tbody>
                        {% endfor %}
                
                </table>
            </div>
            
            {% elif datas | length == 1 %}
            <div class="data-tables">
                <div class="table-all">
                    <table class="table" >
                        <tr>
                            <th>Id</th>
                            <th>Username</th>
                            <th>Debt</th>
                            <th>Edit</th>
                        </tr>
                    
                        {% for data in datas %}
                        <tr>
                            <td>{{data.id-1}}</td>
                            <td>{{data.user}}</td>
                            <td>Rs.{{data.debt}}</td>
                            <td><a href="{{ url_for('edituser', id=data.id) }}" class="btn btn-info">Edit</a></td>
                        </tr>
                            {% endfor %}
                    
                    </table>
                </div>
            </div>
            <div class="return no-user-found">
                <a href="{{ url_for('adduser')}}" class="btn btn-dark btn-lg admin-btn">Add user</a>
                <a href="{{ url_for('admin') }}" class="btn btn-primary btn-lg admin-btn">Return</a>
            </div>
            {% elif datas | length == 0 %}
            <div class="no-user-found">
                <p>No user found!</p>
                <a href="{{ url_for('adduser')}}" class="btn btn-dark btn-lg admin-btn">Add user</a>
                <a href="{{ url_for('admin') }}" class="btn btn-primary btn-lg admin-btn">Return</a>
            </div>
            {% endif %}
        </div>
    </div>

{% endblock %}